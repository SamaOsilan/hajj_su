<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hajj Survey App</title>
<body>
    <style>

body {
  font-family: 'Segoe UI', Tahoma, sans-serif;
  background: linear-gradient(135deg, #0f9d58, #34a853);
  margin: 0;
  padding: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
}

.container {
  background: white;
  width: 95%;
  max-width: 600px;
  padding: 25px;
  border-radius: 15px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.2);
}

h2 {
  text-align: center;
  color: #0f9d58;
  margin-bottom: 20px;
}

h3 {
  text-align: center;
  color: #444;
}

input, select {
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  border-radius: 8px;
  border: 1px solid #ddd;
  font-size: 15px;
  transition: 0.3s;
}

input:focus, select:focus {
  border-color: #34a853;
  outline: none;
  box-shadow: 0 0 5px rgba(52,168,83,0.4);
}

button {
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  border-radius: 8px;
  border: none;
  font-size: 15px;
  font-weight: bold;
  cursor: pointer;
  transition: 0.3s;
  background: linear-gradient(135deg, #0f9d58, #34a853);
  color: white;
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
  overflow: hidden;
  border-radius: 10px;
}

th {
  background-color: #0f9d58;
  color: white;
  padding: 10px;
}

td {
  padding: 10px;
  border-bottom: 1px solid #eee;
}

tr:hover {
  background-color: #f1f1f1;
}

</style>
<div class="container">
<body>
<h2>Hajj Survey App</h2>
<div id="loginDiv">
<input type="text" id="username" placeholder="Enter your name " />
<button onclick="login()">دخول</button>
</div>
<div id="surveyDiv" style="display:none;">
<h3 id="welcomeUser"></h3>
<select id="nationality">
<option value="Pakistan">باكستان</option>
<option value="Egypt">مصر</option>
<option value="India">الهند</option>
<option value="Indonesia">اندونيسيا</option>
<option value="Yemen">اليمن</option>
<option value="Iraq">العراق</option>
<option value="Uzbekistan">اوزباكستان</option>
<option value="Bangladesh">بنجلاديش</option>
<option value="Sudan">السودان</option>
<option value="Algeria">الجزائر</option>
<option value="Morocco">المغرب</option>
<option value="UAE">الامارات</option>
<option value="Kuwait">الكويت</option>
<option value="Libya">ليبيا</option>
<option value="Jordan">الأردن</option>
<option value="Turkey">تركيا</option>
<option value="Iran">ايران</option>
<option value="USA">امريكا</option>
</select>
<select id="gender">
<option value="Male">ذكر</option>
<option value="Female">أنثى</option>
</select>
<button onclick="addEntry()">إضافة</button>
<button onclick="downloadCSV()">تحميل التقرير</button>
<button onclick="resetData()">تصفير اليوم</button>
<table>
<thead>
<tr>
<th>الجنسية</th>
<th>ذكر</th>
<th>أنثى</th>
<th>الإجمالي</th>
</tr>
</thead>
<tbody id="resultTable"></tbody>
</table>
</div>
<script>

// حفظ البيانات لكل مستخدم في LocalStorage

let currentUser = '';

let data = {};

function login() {

  currentUser = document.getElementById('username').value.trim();

  if (!currentUser) {

    alert("Enter your name");

    return;

  }

  // تحميل بيانات المستخدم إذا موجودة

  data = JSON.parse(localStorage.getItem("survey_" + currentUser)) || {};

  document.getElementById('loginDiv').style.display = "none";

  document.getElementById('surveyDiv').style.display = "block";

  document.getElementById('welcomeUser').innerText = "مرحبًا، " + currentUser;

  updateTable();

}

function addEntry() {

  let nat = document.getElementById("nationality").value;

  let gen = document.getElementById("gender").value;

  if (!data[nat]) data[nat] = { Male: 0, Female: 0 };

  data[nat][gen]++;

  localStorage.setItem("survey_" + currentUser, JSON.stringify(data));

  updateTable();

}

function updateTable() {

  let table = document.getElementById("resultTable");

  table.innerHTML = "";

  for (let nat in data) {

    let male = data[nat].Male || 0;

    let female = data[nat].Female || 0;

    let total = male + female;

    table.innerHTML += `
<tr>
<td>${nat}</td>
<td>${male}</td>
<td>${female}</td>
<td>${total}</td>
</tr>

    `;

  }

}

function downloadCSV() {
  // CSV بالعناوين بالانجليزي لتجنب مشاكل Excel
  let csv = "Nationality,Male,Female\n";
  for (let nat in data) {
    let male = data[nat].Male || 0;
    let female = data[nat].Female || 0;
    csv += `"${nat}",${male},${female}\n`; // علامات اقتباس تحمي الاسماء
  }

  let blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
  let url = URL.createObjectURL(blob);
  let a = document.createElement("a");
  a.href = url;
  a.download = "survey_report_" + currentUser + ".csv";
  a.click();
}
function resetData() {

  if (confirm("هل تريد تصفير البيانات؟")) {

    data = {};

    localStorage.setItem("survey_" + currentUser, JSON.stringify(data));

    updateTable();

  }

}
</script>
</body>
</html>
 </div>
</body>

